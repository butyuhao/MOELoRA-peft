































  3%|█████                                                                                                                                                                                | 31/1106 [01:25<47:19,  2.64s/it]


  3%|█████▍                                                                                                                                                                               | 33/1106 [01:30<46:26,  2.60s/it]
[2024-03-31 07:15:58,534] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768



































































  9%|████████████████▎                                                                                                                                                                   | 100/1106 [04:28<44:19,  2.64s/it]




































































































 18%|████████████████████████████████▌                                                                                                                                                   | 200/1106 [08:57<41:14,  2.73s/it]




































































































 27%|████████████████████████████████████████████████▊                                                                                                                                   | 300/1106 [13:26<35:31,  2.64s/it]




































































































 36%|█████████████████████████████████████████████████████████████████                                                                                                                   | 400/1106 [17:52<30:48,  2.62s/it]




































































































 45%|█████████████████████████████████████████████████████████████████████████████████▎                                                                                                  | 500/1106 [22:19<27:02,  2.68s/it]




































































































 54%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                  | 600/1106 [26:46<23:01,  2.73s/it]




































































































 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                  | 700/1106 [31:13<17:50,  2.64s/it]




































































































 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 800/1106 [35:40<13:31,  2.65s/it]




































































































 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 900/1106 [40:06<09:02,  2.63s/it]




































































































 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 1000/1106 [44:32<04:38,  2.63s/it]



































































































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 1099/1106 [48:57<00:18,  2.65s/it]






100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 1105/1106 [49:13<00:02,  2.67s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1106/1106 [49:16<00:00,  2.65s/it][INFO|tokenization_utils_base.py:2171] 2024-03-31 08:03:45,098 >> tokenizer config file saved in saved/moelora/2experts/checkpoint-1106/tokenizer_config.json
[INFO|tokenization_utils_base.py:2178] 2024-03-31 08:03:45,099 >> Special tokens file saved in saved/moelora/2experts/checkpoint-1106/special_tokens_map.json
/cpfs01/user/chenqin.p/anaconda3/envs/moe/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-31 08:03:48,629] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: saved/moelora/2experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt
[2024-03-31 08:03:48,630] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving saved/moelora/2experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt...
[2024-03-31 08:04:05,315] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved saved/moelora/2experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt.
[2024-03-31 08:04:05,388] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving saved/moelora/2experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-31 08:04:05,548] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved saved/moelora/2experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-31 08:04:05,550] [INFO] [engine.py:3488:_save_zero_checkpoint] zero checkpoint saved saved/moelora/2experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-31 08:04:05,550] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1106 is ready now!
{'train_runtime': 2986.8176, 'train_samples_per_second': 11.849, 'train_steps_per_second': 0.37, 'train_loss': 0.6734336502513231, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  train_loss               =     0.6734
  train_runtime            = 0:49:46.81
  train_samples            =      35392
  train_samples_per_second =     11.849
  train_steps_per_second   =       0.37
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1106/1106 [49:37<00:00,  2.69s/it]