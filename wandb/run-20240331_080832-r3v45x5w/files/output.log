









































  4%|██████▋                                                                                                                                                                            | 41/1106 [03:12<1:20:54,  4.56s/it]


  4%|██████▉                                                                                                                                                                            | 43/1106 [03:21<1:20:28,  4.54s/it]

























































  9%|████████████████                                                                                                                                                                  | 100/1106 [07:41<1:16:28,  4.56s/it]



































































































 18%|████████████████████████████████                                                                                                                                                  | 199/1106 [15:12<1:13:05,  4.84s/it]




































































 27%|████████████████████████████████████████████████                                                                                                                                  | 299/1106 [22:48<1:01:12,  4.55s/it]





 27%|█████████████████████████████████████████████████▍                                                                                                                                  | 304/1106 [23:10<59:18,  4.44s/it]































































































 36%|████████████████████████████████████████████████████████████████▉                                                                                                                   | 399/1106 [30:17<52:45,  4.48s/it]




































































































 45%|█████████████████████████████████████████████████████████████████████████████████▏                                                                                                  | 499/1106 [37:44<45:05,  4.46s/it]




































































































 54%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 599/1106 [45:12<40:20,  4.77s/it]




































































































 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                  | 699/1106 [52:49<31:37,  4.66s/it]




































































































 72%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                 | 799/1106 [1:00:25<22:31,  4.40s/it]




































































































 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 899/1106 [1:09:56<15:14,  4.42s/it]





































































































 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                 | 1000/1106 [1:17:24<07:43,  4.38s/it]




































































































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ | 1100/1106 [1:24:49<00:26,  4.42s/it]





100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1106/1106 [1:25:16<00:00,  4.48s/it][INFO|tokenization_utils_base.py:2171] 2024-03-31 09:33:54,303 >> tokenizer config file saved in saved/moelora/4experts/checkpoint-1106/tokenizer_config.json
[INFO|tokenization_utils_base.py:2178] 2024-03-31 09:33:54,303 >> Special tokens file saved in saved/moelora/4experts/checkpoint-1106/special_tokens_map.json
/cpfs01/user/chenqin.p/anaconda3/envs/moe/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-31 09:33:54,350] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1106 is about to be saved!
[2024-03-31 09:33:57,694] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: saved/moelora/4experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt
[2024-03-31 09:33:57,694] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving saved/moelora/4experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1106/1106 [1:25:37<00:00,  4.65s/it]
[2024-03-31 09:34:14,440] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved saved/moelora/4experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt.
[2024-03-31 09:34:14,503] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving saved/moelora/4experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-31 09:34:14,778] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved saved/moelora/4experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-31 09:34:14,780] [INFO] [engine.py:3488:_save_zero_checkpoint] zero checkpoint saved saved/moelora/4experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-31 09:34:14,780] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1106 is ready now!
{'train_runtime': 5147.3779, 'train_samples_per_second': 6.876, 'train_steps_per_second': 0.215, 'train_loss': 0.7017397173490059, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  train_loss               =     0.7017
  train_runtime            = 1:25:47.37
  train_samples            =      35392
  train_samples_per_second =      6.876
  train_steps_per_second   =      0.215