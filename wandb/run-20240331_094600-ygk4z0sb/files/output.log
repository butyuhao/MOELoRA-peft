  0%|                                                                                                        | 0/1106 [00:00<?, ?it/s][34m[1mwandb[39m[22m: Network error (SSLError), entering retry loop.






























































































  9%|████████▎                                                                                   | 100/1106 [15:02<2:30:09,  8.96s/it]































































































 18%|████████████████▋                                                                           | 200/1106 [29:48<2:13:17,  8.83s/it]




































































































 27%|████████████████████████▉                                                                   | 300/1106 [44:32<1:58:26,  8.82s/it]




































































































 36%|█████████████████████████████████▎                                                          | 400/1106 [59:15<1:44:36,  8.89s/it]



































































































 45%|████████████████████████████████████████▌                                                 | 499/1106 [1:13:48<1:29:29,  8.85s/it]




































































































 54%|████████████████████████████████████████████████▋                                         | 599/1106 [1:28:27<1:14:49,  8.85s/it]




































































































 63%|██████████████████████████████████████████████████████████▏                                 | 699/1106 [1:43:05<58:53,  8.68s/it]




































































































 72%|██████████████████████████████████████████████████████████████████▍                         | 799/1106 [1:57:42<45:06,  8.81s/it]





































































































 81%|██████████████████████████████████████████████████████████████████████████▊                 | 900/1106 [2:12:28<29:53,  8.71s/it]




































































































 90%|██████████████████████████████████████████████████████████████████████████████████▎        | 1000/1106 [2:27:01<15:24,  8.72s/it]




































































































 99%|██████████████████████████████████████████████████████████████████████████████████████████▌| 1100/1106 [2:41:32<00:52,  8.69s/it]






100%|███████████████████████████████████████████████████████████████████████████████████████████| 1106/1106 [2:42:24<00:00,  8.66s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████| 1106/1106 [2:42:24<00:00,  8.66s/it][INFO|tokenization_utils_base.py:2171] 2024-03-31 12:29:00,709 >> tokenizer config file saved in saved/moelora/8experts/checkpoint-1106/tokenizer_config.json
[INFO|tokenization_utils_base.py:2178] 2024-03-31 12:29:00,709 >> Special tokens file saved in saved/moelora/8experts/checkpoint-1106/special_tokens_map.json
/cpfs01/user/chenqin.p/anaconda3/envs/moe/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-31 12:29:04,156] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: saved/moelora/8experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt
[2024-03-31 12:29:04,156] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving saved/moelora/8experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt...
[2024-03-31 12:29:20,750] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved saved/moelora/8experts/checkpoint-1106/global_step1106/mp_rank_00_model_states.pt.
[2024-03-31 12:29:20,819] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving saved/moelora/8experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-31 12:29:21,320] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved saved/moelora/8experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-31 12:29:21,322] [INFO] [engine.py:3488:_save_zero_checkpoint] zero checkpoint saved saved/moelora/8experts/checkpoint-1106/global_step1106/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-31 12:29:21,322] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1106 is ready now!
{'train_runtime': 9809.8658, 'train_samples_per_second': 3.608, 'train_steps_per_second': 0.113, 'train_loss': 0.7312576046472863, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  train_loss               =     0.7313
  train_runtime            = 2:43:29.86
  train_samples            =      35392
  train_samples_per_second =      3.608
  train_steps_per_second   =      0.113
100%|███████████████████████████████████████████████████████████████████████████████████████████| 1106/1106 [2:42:45<00:00,  8.83s/it]